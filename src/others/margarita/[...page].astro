---
import { getCollection } from 'astro:content'
import Layout from '@layouts/Layout.astro'
import Horizontal from '@components/Horizontal.astro'
import Card from '@components/Card.astro'
import Pagination from '@components/Pagination.astro'

export async function getStaticPaths({ paginate }) {
  const commercesFromCity = await getCollection('margarita')

  return paginate(commercesFromCity, {
    pageSize: 8
  })
}
const { page } = Astro.props
---

<Layout>
  <Horizontal 
    title={ 'Â¡Conecta con los mejores comercios de Margarita!' }
    content={ 'Lista de los mejores comercios de la ciudad' }
    image={ '/banners/banner-wtf.png' }
    hasCTA={ true }
    action={ '/directorio' }
    actionName={ 'Directorio' }
  />
  <div class="bg-slate text-center">
    <div class="custom-container">
      <div class="grid gap-4 grid-cols-4">
        {
          page.data.map(commerce => (
            <Card 
              tag={ commerce.data.tag }
              name={ commerce.data.name }
              address={ commerce.data.address }
              cta={ `/directorio/margarita/${commerce.slug}` }
            />
          ))
        }
      </div>
    </div>
    <Pagination 
      prevUrl={ page.url.prev } 
      nextUrl={ page.url.next } 
      currentPage={ page.currentPage } 
    />
  </div>
</Layout>